<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet" />
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet"> -->
  <title>Patient Details</title>
</head>

<body>
  <!-- component -->
  <div class="bg-white">
    <header class="absolute inset-x-0 top-0 z-50">
      <nav class="flex items-center justify-between p-6 lg:px-8" aria-label="Global">
        <div class="flex lg:flex-1">
          <a href="#" class="-m-1.5 p-1.5">
            <span class="sr-only">Heart Faliure Prediction</span>
          </a>
        </div>
        <div class="flex lg:hidden">
          <button type="button" class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700">
            <span class="sr-only">Open main menu</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
              aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
          </button>
        </div>
        <div class="hidden lg:flex lg:gap-x-12">
          <a href="/predict" class="text-sm font-semibold leading-6 text-gray-900 border-b border-gray-900/10">Heart
            Prediction</a>
          <a href="/results" class="text-sm font-semibold leading-6 text-gray-900 border-b border-gray-900/10">Patient
            Details</a>
        </div>
        <div class="hidden lg:flex lg:flex-1 lg:justify-end">
          <a href="#" class="text-sm font-semibold leading-6 text-gray-900">Log out <span
              aria-hidden="true">&rarr;</span></a>
        </div>
      </nav>
      <!-- Mobile menu, show/hide based on menu open state. -->
      <div class="lg:hidden" role="dialog" aria-modal="true">
        <!-- Background backdrop, show/hide based on slide-over state. -->
        <div class="fixed inset-0 z-50"></div>
        <div
          class="fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10">
          <div class="flex items-center justify-between">
            <a href="#" class="-m-1.5 p-1.5">
              <span class="sr-only">Heart Faliure Prediction</span>
            </a>
            <button type="button" class="-m-2.5 rounded-md p-2.5 text-gray-700">
              <span class="sr-only">Close menu</span>
              <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <div class="mt-6 flow-root">
            <div class="-my-6 divide-y divide-gray-500/10">
              <div class="space-y-2 py-6">
                <a href="/predict"
                  class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50">Heart
                  Prediction</a>
                <a href="/results"
                  class="-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50">Patient
                  Details</a>
              </div>
              <div class="py-6">
                <a href="#"
                  class="-mx-3 block rounded-lg px-3 py-2.5 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50">Log
                  out</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="relative isolate px-6 pt-14 lg:px-8">
      <div class="absolute inset-x-0 -top-20 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80"
        aria-hidden="true">
        <div
          class="relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]"
          style="
                clip-path: polygon(
                  74.1% 44.1%,
                  100% 61.6%,
                  97.5% 26.9%,
                  85.5% 0.1%,
                  80.7% 2%,
                  72.5% 32.5%,
                  60.2% 62.4%,
                  52.4% 68.1%,
                  47.5% 58.3%,
                  45.2% 34.5%,
                  27.5% 76.7%,
                  0.1% 64.9%,
                  17.9% 100%,
                  27.6% 76.8%,
                  76.1% 97.7%,
                  74.1% 44.1%
                );
              "></div>
      </div>
      <div class="container px-4 mx-auto ">
        <div class="text-center ">
          <section class="container px-4 mx-auto">
            <div class="sm:flex sm:items-center sm:justify-between"></div>

            <div class="mt-6 md:flex md:items-center md:justify-between"></div>

            <div class="relative flex items-center mt-4 md:mt-0">
              <button id="search-button">
                <span class="absolute">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-5 h-5 mx-3 text-gray-400 dark:text-gray-600">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                  </svg>
                </span>
              </button>
              <input id="search-input" type="text" placeholder="Search"
                class="block w-full py-1.5 pr-5 text-gray-700 bg-white border border-gray-200 rounded-lg md:w-80 placeholder-gray-400/70 pl-11 rtl:pr-11 rtl:pl-5 dark:bg-gray-900 dark:text-gray-300 dark:border-gray-600 focus:border-blue-400 dark:focus:border-blue-300 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40" />
            </div>
        </div>

        <div class="flex flex-col mt-6">
          <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
            <div class="inline-block min-w-full py-2 align-middle md:px-6 lg:px-8">
              <div class="overflow-hidden border border-gray-200 dark:border-gray-700 md:rounded-lg">
                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                  <thead class="bg-gray-50 dark:bg-gray-800">
                    <tr>
                      <th scope="col"
                        class="py-4 px-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        National ID
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Age
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Anaemia
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Creatinine Phosphokinase
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Diabetes
                      </th>
                      <th scope="col"
                        class="py-4 px-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Ejection Fraction
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        High Blood Pressure
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Platelets
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Serum Creatinine
                      </th>

                      <th scope="col"
                        class="px-4 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Serum Sodium
                      </th>
                      <th scope="col"
                        class="px-12 py-4 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Sex
                      </th>

                      <th scope="col"
                        class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Smoking
                      </th>

                      <th scope="col"
                        class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Time
                      </th>

                      <th scope="col"
                        class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        Result
                      </th>

                    </tr>
                  </thead>
                  <tbody id="patients-list"
                    class="bg-white divide-y divide-gray-200 dark:divide-gray-700 dark:bg-gray-900">
                    <!-- Results will be dynamically added here -->

                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-6 sm:flex sm:items-center sm:justify-between">
          <div class="text-sm text-gray-500 dark:text-gray-400">
            Page
            <span class="font-medium text-gray-700 dark:text-gray-100">1 of 10</span>
          </div>

          <div class="flex items-center mt-4 gap-x-4 sm:mt-0">
            <a href="#"
              class="flex items-center justify-center w-1/2 px-5 py-2 text-sm text-gray-700 capitalize transition-colors duration-200 bg-white border rounded-md sm:w-auto gap-x-2 hover:bg-gray-100 dark:bg-gray-900 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-800">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-5 h-5 rtl:-scale-x-100">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18" />
              </svg>

              <span> previous </span>
            </a>

            <a href="#"
              class="flex items-center justify-center w-1/2 px-5 py-2 text-sm text-gray-700 capitalize transition-colors duration-200 bg-white border rounded-md sm:w-auto gap-x-2 hover:bg-gray-100 dark:bg-gray-900 dark:text-gray-200 dark:border-gray-700 dark:hover:bg-gray-800">
              <span> Next </span>

              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-5 h-5 rtl:-scale-x-100">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" />
              </svg>
            </a>
          </div>
        </div>
        </section>
      </div>
    </div>
  </div>
  <script>
    async function fetchPatients() {
      const response = await fetch("/patients");
      const patients = await response.json();
      const patientsList = document.getElementById("patients-list");


      const convertRisk = (value) => (value === 1 ? 'High Risk' : 'Low Risk');
      // const convertYesNo = (value) => (value === 1 ? 'Yes' : 'No');
      // const convertMaleFemale = (value) => (value === 0 ? 'Male' : 'Female');


      patientsList.innerHTML = patients
        .map(
          (patient) => `
                <tr class="border border-gray-300">
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="font-medium text-gray-800 dark:text-white">
                        ${patient.national_id}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.age}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.anaemia}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.creatinine_phosphokinase}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.diabetes}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.ejection_fraction}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.high_blood_pressure}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.platelets}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.serum_creatinine}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.serum_sodium}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.sex}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.smoking}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.features.time}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${convertRisk(patient.prediction)}
                      </h2>
                    </div>
                  </td>
                </tr>
                
              `
        )
        .join("");
    }

    fetchPatients();
  </script>
  <script>
    document.getElementById('search-button').addEventListener('click', async () => {
      const searchInput = document.getElementById('search-input').value.trim();
      if (searchInput) {
        const response_id = await fetch(`/patients?national_id=${searchInput}`);
        console.log(response_id);
        const patient = await response_id.json();
        const patientsList = document.getElementById('patients-list');

        patientsList.innerHTML = '';

        if (patient) {
          patientsList.innerHTML = `
          <tr class="border border-gray-300">
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="font-medium text-gray-800 dark:text-white">
                        ${patient.national_id}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.age}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.anaemia}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.creatinine_phosphokinase}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.diabetes}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.ejection_fraction}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.high_blood_pressure}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.platelets}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.serum_creatinine}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.serum_sodium}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.sex}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.smoking}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.time}
                      </h2>
                    </div>
                  </td>
                  <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                    <div>
                      <h2 class="text-center font-medium text-gray-800 dark:text-white">
                        ${patient.prediction}
                      </h2>
                    </div>
                  </td>
                </tr>
        `;
        } else {
          patientsList.innerHTML = '<tr><td colspan="14" class="text-center border border-gray-300 px-4 py-2">No results found</td></tr>';
        }
      } else {
        alert("Please enter a valid National ID.");
      }
    });


  </script>
</body>

</html>


</div>